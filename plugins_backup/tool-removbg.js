/*\n* إضافة: إزالة خلفية الصورة\n* وصف: تزيل هذه الإضافة خلفية أي صورة يتم إرسالها.\n* المترجم والمعدل: Hilman\n*/\n\nimport axios from 'axios';\n\nasync function removebg(buffer) {\n    try {\n        const imageBase64 = buffer.toString(\"base64\");\n        const response = await axios.post(\n            \"https://us-central1-ai-apps-prod.cloudfunctions.net/restorePhoto\",\n            { \n                image: `data:image/png;base64,${imageBase64}`,\n                model: \"fb8af171cfa1616ddcf1242c093f9c46bcada5ad4cf6f2fbe8b81b330ec5c003\",\n            }\n        );\n\n        const resultData = response.data?.replace(/\\\"/g, \"\");\n        if (!resultData) throw new Error('فشل في تحليل استجابة الخادم.');\n\n        return resultData;\n    } catch (e) {\n        throw new Error(`خطأ في واجهة برمجة التطبيقات: ${e.message}`);\n    }\n}\n\nconst handler = async (m, { conn, usedPrefix, command }) => {\n    await m.react('⏳');\n\n    try {\n        const q = m.quoted ? m.quoted : m;\n        const mime = (q.msg || q).mimetype || '';\n\n        if (!mime.startsWith('image/')) {\n            throw new Error(`*يرجى الرد على صورة أو إرسالها.*\n*مثال:* ${usedPrefix + command}`);\n        }\n\n        const media = await q.download();\n        const resultUrl = await removebg(media);\n\n        await conn.sendMessage(m.chat, { \n            image: { url: resultUrl },\n            caption: '✅ تمت إزالة الخلفية بنجاح!'\n        }, { quoted: m });\n\n        await m.react('✅');\n\n    } catch (error) {\n        await m.react('❌');\n        m.reply(`*خطأ:* ${error.message}`);\n    }\n};\n\nhandler.help = ['removebg', 'ازالة-الخلفية'];\nhandler.command = ['removebg', 'rbg', 'ازالة-الخلفية'];\nhandler.tags = ['tools'];\nhandler.limit = true;\n\nexport default handler;\n