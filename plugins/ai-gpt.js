/*\n* إضافة: GPT Online\n* وصف: تتيح هذه الإضافة للمستخدمين التفاعل مع نموذج لغوي كبير (GPT) للحصول على إجابات ومعلومات.\n* المترجم والمعدل: Hilman\n*/\n\nimport axios from 'axios';\nimport FormData from 'form-data';\n\nasync function gptOnline(message) {\n  const referer = 'https://gptonline.ai/ar/chatgpt-online/';\n\n  try {\n    const { data: html } = await axios.get(referer);\n    const attrs = {}\n    const attrList = ['nonce', 'post-id', 'bot-id', 'url'];\n\n    for (const key of attrList) {\n      const match = html.match(new RegExp(`data-${key}=\"([^\"]+)\"`));\n      if (!match) throw new Error(`لم يتم العثور على السمة المطلوبة: ${key}. قد تكون الخدمة قد تغيرت.`);\n      attrs[key] = match[1];\n    }\n\n    const form = new FormData();\n    const clientId = 'sU' + Math.random().toString(36).slice(2, 10);\n\n    form.append('_wpnonce', attrs['nonce']);\n    form.append('post_id', attrs['post-id']);\n    form.append('url', attrs['url']);\n    form.append('action', 'wpaicg_chat_shortcode_message');\n    form.append('message', message);\n    form.append('bot_id', attrs['bot-id']);\n    form.append('chatbot_identity', `custom_bot_${attrs['bot-id']}`);\n    form.append('wpaicg_chat_history', JSON.stringify([{ role: 'user', content: message }]));\n    form.append('wpaicg_chat_client_id', clientId);\n\n    const { data: responseData } = await axios.post(\n      'https://gptonline.ai/ar/wp-admin/admin-ajax.php',\n      form,\n      {\n        headers: {\n          ...form.getHeaders(),\n          Referer: referer,\n          Origin: 'https://gptonline.ai',\n          'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36',\n        }\n      }\n    );\n\n    return responseData.data || '❌ لم يتم استلام أي رد من الذكاء الاصطناعي.';\n  } catch (err) {\n    console.error(err); // Log the full error for debugging\n    throw new Error('فشل الاتصال بالخدمة. يرجى المحاولة مرة أخرى لاحقًا.');\n  }\n}\n\nconst handler = async (m, { text, usedPrefix, command }) => {\n  if (!text) {\n    return m.reply(`*يرجى إدخال سؤالك أو استفسارك.*\n*مثال:* ${usedPrefix + command} ما هي فوائد الذكاء الاصطناعي؟`);\n  }\n\n  await m.react('⏳');\n\n  try {\n    const result = await gptOnline(text);\n    const formattedResult = `\n*「 🤖 GPT Online 」*\n\n${result}\n        `.trim();\n\n    await m.reply(formattedResult);\n    await m.react('✅');\n\n  } catch (error) {\n    await m.react('❌');\n    m.reply(`*خطأ:* ${error.message}`);\n  }\n};\n\nhandler.help = ['gpt <question>', 'جي-بي-تي <سؤال>'];\nhandler.tags = ['ai'];\nhandler.command = /^(gptonline|gpt|جي-بي-تي)$/i;\nhandler.limit = true;\nhandler.register = true;\n\nexport default handler;\n