/*\nâœ¨ ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø©: Hilman\nğŸ’« Ø§Ø³Ù… Ø§Ù„Ù…ÙŠØ²Ø©: Ø§Ù„ØªØ³Ø¬ÙŠÙ„\nğŸ¤– Ø§Ù„Ù†ÙˆØ¹: Ø¥Ø¶Ø§ÙØ© ESM\nğŸ”— Ø§Ù„Ù…ØµØ¯Ø±: https://whatsapp.com/channel/0029Vb6gsqN8fewx89iCtV19\n*/\n\nimport { createHash } from \'crypto\'\nimport moment from \'moment-timezone\'\n\n// Regex to validate name (including Arabic characters) and age\nlet Reg = /^([\\p{L}\\s]+),(\\d{1,3})$/u\n\nlet handler = async function (m, { text, usedPrefix, command, conn }) {\n  let d = new Date(new Date() + 3600000)\n  let locale = \'ar-SA\' // Using Saudi Arabia locale for Arabic\n  let week = d.toLocaleDateString(locale, { weekday: \'long\' })\n  let date = d.toLocaleDateString(locale, { day: \'numeric\', month: \'long\', \'year\': \'numeric\' })\n  let time = d.toLocaleTimeString(locale, { hour: \'numeric\', minute: \'numeric\', second: \'numeric\', hour12: true })\n  \n  let pp\n  try {\n    pp = await conn.profilePictureUrl(m.sender, \'image\')\n  } catch {\n    pp = \'https://telegra.ph/file/24fa902ead26340f3df2c.png\' // Default avatar\n  }\n\n  let user = global.db.data.users[m.sender]\n  let sn = createHash(\'md5\').update(m.sender).digest(\'hex\')\n\n  if (user.registered) {\n    let oldname = user.name\n    let oldage = user.age\n    let oldreg = user.regTime\n    \n    let caption = `\nâ— *Ø£Ù†Øª Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„ÙØ¹Ù„*\n\n*Ø§Ù„Ø§Ø³Ù…:* ${oldname}\n*Ø§Ù„Ø¹Ù…Ø±:* ${oldage} Ø³Ù†Ø©\n\nØ¥Ø°Ø§ ÙƒÙ†Øª ØªØ±ØºØ¨ ÙÙŠ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ù…Ø± Ø§Ù„ØªØ§Ù„ÙŠ:\n*${usedPrefix}unreg ${sn}*\n`\n    return conn.reply(m.chat, caption, m)\n  }\n\n  if (!Reg.test(text)) {\n    return m.reply(`*ØªÙ†Ø³ÙŠÙ‚ ØºÙŠØ± ØµØ­ÙŠØ­*\\n\\nØ§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØµØ­ÙŠØ­:\\n*${usedPrefix + command}* Ø§Ø³Ù…Ùƒ,Ø¹Ù…Ø±Ùƒ\\n\\n*Ù…Ø«Ø§Ù„:*\\n*${usedPrefix + command}* Ø£Ø­Ù…Ø¯,25`)\n  }\n\n  let [_, name, ageStr] = text.match(Reg)\n  let age = parseInt(ageStr)\n\n  if (!name || !age) return m.reply(\'*Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø¹Ù…Ø± ØºÙŠØ± ØµØ§Ù„Ø­!*\')\n  if (name.length > 30) return m.reply(\'Ø§Ù„Ø§Ø³Ù… Ø·ÙˆÙŠÙ„ Ø¬Ø¯Ù‹Ø§ØŒ Ø¨Ø­Ø¯ Ø£Ù‚ØµÙ‰ 30 Ø­Ø±ÙÙ‹Ø§.\')\n  if (age < 10 || age > 80) return m.reply(\'ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø¹Ù…Ø± Ø¨ÙŠÙ† 10 - 80 Ø³Ù†Ø©.\')\n\n  user.name = name.trim()\n  user.age = age\n  user.regTime = +new Date()\n  user.registered = true\n\n  let caption = `\nâ”Œâ”€ã€Œ *âœ… ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­* ã€\nâ”‚ \nâ”‚- *Ø§Ù„Ø§Ø³Ù…:* ${name}\nâ”‚- *Ø§Ù„Ø¹Ù…Ø±:* ${age} Ø³Ù†Ø©\nâ”‚- *Ø§Ù„ØªØ§Ø±ÙŠØ®:* ${date}\nâ”‚- *Ø§Ù„ÙˆÙ‚Øª:* ${time}\nâ”‚- *Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ:* \nâ”‚  \`${sn}\`\nâ”‚ \nâ””â”€ã€Œ *CRIMSON - BOT* ã€\n\nÙ…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ! Ù„Ù‚Ø¯ Ø£ØµØ¨Ø­Øª Ø§Ù„Ø¢Ù† Ø¬Ø²Ø¡Ù‹Ø§ Ù…Ù† Ù…Ø¬ØªÙ…Ø¹Ù†Ø§.\nØ§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ù…Ø± *.Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©* Ù„Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù…ØªØ§Ø­Ø©.\n`.trim()\n\n  await conn.sendMessage(m.chat, {\n    image: { url: pp },\n    caption: caption,\n    contextInfo: {\n      externalAdReply: {\n        title: \"ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­\",\n        body: user.name,\n        thumbnailUrl: pp,\n        sourceUrl: \"https://whatsapp.com/channel/0029Vb6gsqN8fewx89iCtV19\",\n        mediaType: 1,\n        renderLargerThumbnail: true\n      }\n    }\n  }, { quoted: m })\n}\n\nhandler.help = [\'ØªØ³Ø¬ÙŠÙ„ <Ø§Ø³Ù…>,<Ø¹Ù…Ø±>\']\nhandler.tags = [\'main\']\nhandler.command = /^(daftar|register|reg|ØªØ³Ø¬ÙŠÙ„|verify|ØªØ­Ù‚Ù‚)$/i\n\nexport default handler\n